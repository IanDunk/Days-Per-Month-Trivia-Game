<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <!-- Bootstrap File -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery.js"></script>

    <!-- css: reset, style -->
    <link rel="stylesheet" type="text/css" href="assets/css/reset.css">
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">

</head>

<body>

    <div class="container">

        <!-- Jumbotron -->
        <div class="jumbotron">
            <h1 class="text-center">
                <strong>Do you Know your Days of the Year?</strong>
            </h1>
            <h2 class="text-center" id="display"></h2>
        </div>

        <!-- End of container -->
    </div>

    <!-- container for trivia game -->
    <div class="container" id="trivia-game"></div>

    <!-- container for begin -->
    <div class"container" id-"trivia-begin">
        <div class="row text-center">
            <p>Last days of the month quiz!</p>
            <button class="begin">Take Quiz</button>
        </div>
    </div>

    <!-- container for loss -->
    <div class="container" id="trivia-loss"></div>




    <script>
        
        // Month and Answer variables
        var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        var correctAnswers = ["january-3", "february-1", "march-3", "april-2", "may-3", "june-2", "july-3", "august-3", "september-2", "october-3", "november-2", "december-3"];

        // Interval
        var intervalId;
        var clockRunning = false;
        var time = 30;

        // Divs for functions
        var rowDiv = "<div class='row text-center'>";
        var endDiv = "</div>";



        function start() {
            if(!clockRunning) {
                clockRunning = true;
                intervalId = setInterval(count, 200);
            }
        }

        function count() {
            if(time > 0) {
                time--;
            } else {
                clearInterval(intervalId);
                clockRunning = false;
                endGame();
            }
            $("#display").text("Time Left: " + time);
        }


        // Game ends when count equals 0
        function endGame() {
            
            var rowScore = "<p>You scored " + calculateScore() + " out of 12!</p>";
            var rowWrong = "<p>Answers incorrect: " + questionsWrong() + "</p>";
            var rowUnanswered = "<p>Questions unanswered: " + questionsUnanswered() + "</p>";

            $("#trivia-loss").append(rowDiv + rowScore + endDiv);
            $("#trivia-loss").append(rowDiv + rowWrong + endDiv);
            $("#trivia-loss").append(rowDiv + rowUnanswered + endDiv);

            $("#trivia-game").hide();
            $("#trivia-loss").show();
        }

        function resetGame() {
            time = 30;

            // Erasing html on page
            $("#trivia-loss").html("");
            $("#trivia-game").html("");

            // Repringing questions on page
            for(var i = 0; i < months.length; i++) {
                makeQuestion(months[i]);
            }

            // Swithcing displays to trivia game
            $("#trivia-begin").hide();
            $("#trivia-loss").hide();
            $("#trivia-game").show();
            $("#display").text("Time Left: " + time); // Needed to make it say 30 when game reset instead of 29

            start();
        }

        // Create a question taking in the month name and printing to html with question and radio button options below
        function makeQuestion(month) {

            var rowP = "<p>What is the last day of " + month  + "?</p>";

            // Question
            $("#trivia-game").append(rowDiv + rowP + endDiv);

            var formAction = "<form id='" + month + "'>";  // make sure form action (now id) is ok with having month instead of ""
            var radioButton1 = "<input type='radio' name='" + month.toLowerCase() + "' id='" + month.toLowerCase() + "-1" + "'>";
            var radioButton2 = "<input type='radio' name='" + month.toLowerCase() + "' id='" + month.toLowerCase() + "-2" + "'>";
            var radioButton3 = "<input type='radio' name='" + month.toLowerCase() + "' id='" + month.toLowerCase() + "-3" + "'>";
            var endFormAction = "</form>"

            // Radio buttons
            $("#trivia-game").append(rowDiv + formAction + radioButton1 + " 28 " + radioButton2 + " 30 " + radioButton3 + " 31 " + endFormAction + endDiv);
        }

        // Cycles through correct answers and sees if they're checked (clicked)
        function calculateScore() { 
            var score = 0;

            for(var i = 0; i < correctAnswers.length; i++) {
                if(document.getElementById(correctAnswers[i]).checked) { 
                    score++; 
                }
            }
            return score;
        }

        // Unanswered Questions
        function questionsUnanswered() {
            var unanswered = 0;

            for(var i = 0; i < months.length; i++) {
                if ($('input[name=' + months[i].toLowerCase() + ']:checked').length === 0) {
                    unanswered++;
                }
            }
            return unanswered;
        }

        // Incorrect Answers
        function questionsWrong() {
            return 12 - questionsUnanswered() - calculateScore();
        }

        $(document).ready(function() {

            $(".begin").on("click", resetGame);
        });


    </script>
</body>

</html>